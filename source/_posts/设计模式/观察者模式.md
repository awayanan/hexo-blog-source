---
title: è§‚å¯Ÿè€…æ¨¡å¼
categories:
  - æŠ€æœ¯ç¬”è®°
tags:
  - è®¾è®¡æ¨¡å¼
  - è¡Œä¸ºå‹æ¨¡å¼
date: 2023-02-19 01:19:19
---
  
> è®©ä½ çš„å¯¹è±¡çŸ¥æ‚‰ç°å†µ


## introduction

æŒ‡å¤šä¸ªå¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚
åˆç§°ä½œ`å‘å¸ƒ-è®¢é˜…æ¨¡å¼`ã€`æ¨¡å‹-è§†å›¾æ¨¡å¼`ï¼Œå®ƒæ˜¯å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚

è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š
- æŠ½è±¡ä¸»é¢˜(å¯è§‚å¯Ÿè€…)ï¼ˆSubjectï¼‰è§’è‰²ï¼šä¹Ÿå«æŠ½è±¡ç›®æ ‡ç±»ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äºä¿å­˜è§‚å¯Ÿè€…å¯¹è±¡çš„èšé›†ç±»å’Œå¢åŠ ã€åˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡çš„æ–¹æ³•ï¼Œä»¥åŠé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…çš„æŠ½è±¡æ–¹æ³•ã€‚
- å…·ä½“ä¸»é¢˜ï¼ˆConcrete Subjectï¼‰è§’è‰²ï¼šä¹Ÿå«å…·ä½“ç›®æ ‡ç±»ï¼Œå®ƒå®ç°æŠ½è±¡ç›®æ ‡ä¸­çš„é€šçŸ¥æ–¹æ³•ï¼Œå½“å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œé€šçŸ¥æ‰€æœ‰æ³¨å†Œè¿‡çš„è§‚å¯Ÿè€…å¯¹è±¡ã€‚
- æŠ½è±¡è§‚å¯Ÿè€…(è§‚å¯Ÿè€…)ï¼ˆObserverï¼‰è§’è‰²ï¼šå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªæ›´æ–°è‡ªå·±çš„æŠ½è±¡æ–¹æ³•ï¼Œå½“æ¥åˆ°å…·ä½“ä¸»é¢˜çš„æ›´æ”¹é€šçŸ¥æ—¶è¢«è°ƒç”¨ã€‚
- å…·ä½“è§‚å¯Ÿè€…ï¼ˆConcrete Observerï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è§‚å¯Ÿè€…ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨å¾—åˆ°ç›®æ ‡çš„æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªèº«çš„çŠ¶æ€ã€‚

## principle
- é’ˆå¯¹è§£æ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å®ç°ç¼–ç¨‹
- å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿

## implement ğŸŒ°
![](http://www.plantuml.com/plantuml/png/jLDDJy904BttL-onHEql88O4l6ayzE31U1Yw0upPZsPc5aEG_ou8cs8KIZIUshutysRovdKa2gp9kuA28i-WGTD4NyMf82-HMr153jNZuTkiYokpZ6HDQYqebZQcgSFhBuz1iUcHgzFq5Hljr1Zd98gSvvJvPT1L-BZ4qto8IhDLXgNiNs92qZfOtJdq68vsiNlyKw5n8F9ZznE2Bf0deB1jlJ7t93hCuszDBfSjjNV5AFeM6JGnTk0YURAagmvf6KKIupzQamcFi9laCQYC5n3cQ3jIK1-E-9ENxhMeLb2AeIQV76ZSPsWjExJP71O12cMjJ67-_79UT9oOCUWu1aixMJcSqQp_udGEv5jtrUznk2pvHN4kySFtgkhBKt7s3ymA5pjJz8V_5w8Z33Pvzm40)

Observeræ¥å£
```java
package com.observerpattern;

/**
 * @author cuiliu
 */
public interface Observer {
    public void update(double temperature, double humidity, double pressure);
}
```

Subjectæ¥å£
```java
package com.observerpattern;

/**
 * @author cuiliu
 */
public interface Subject {
    public void registerObserver(Observer o);
    public void removeObserver(Observer o);
    public void notifyObservers();
}
```

DisplayElement
```java
package com.observerpattern;
/**
 * @author cuiliu
 */
public interface DisplayElement {
    public void display();
}
```

WeatherDataå®ç°Subjectæ¥å£
```java
package com.observerpattern;

import java.util.ArrayList;
import java.util.List;
/**
 * @author cuiliu
 */
public class WeatherData implements Subject{
    private final List<Observer> observers;
    private double temperature;
    private double humidity;
    private double pressure;

    public WeatherData(){
        observers = new ArrayList<>();
    }
    @Override
    public void registerObserver(Observer o) {
        observers.add(o);
    }

    @Override
    public void removeObserver(Observer o) {
        int index = observers.indexOf(o);
        if(index >= 0){
            observers.remove(index);
        }
    }

    @Override
    public void notifyObservers() {
        for (Observer observer : observers) {
            observer.update(temperature, humidity, pressure);
        }
    }

    public void measurementsChanged(){
        notifyObservers();
    }

    public void setMeasurements(double temperature, double humidity, double pressure){
        this.temperature = temperature;
        this.humidity = humidity;
        this.pressure = pressure;
        measurementsChanged();
    }
}
```

å¸ƒå‘Šæ¿å®ç°Observerå’ŒDisplayElementæ¥å£
```java
package com.observerpattern;

import lombok.extern.slf4j.Slf4j;

/**
 * @author cuiliu
 */
@Slf4j
public class CurrentConditionsDisplay implements Observer, DisplayElement{
    private double temperature;
    private double humidity;
    private double pressure;
    public Subject weatherData;

    public CurrentConditionsDisplay(Subject weatherData){
        this.weatherData = weatherData;
        weatherData.registerObserver(this);
    }

    @Override
    public void display() {
        log.info("Current conditions: " + temperature + " F degrees and " + humidity + " % humidity and " + pressure + " pressure");
    }

    @Override
    public void update(double temperature, double humidity, double pressure) {
        this.temperature = temperature;
        this.humidity = humidity;
        this.pressure = pressure;
        display();
    }
}
```

å®Œæ•´çš„æ°”è±¡ç«™æµ‹è¯•
```java
package com.observerpattern;

/**
 * @author cuiliu
 */
public class WeatherStationSimulator {
    public static void main(String[] args) {
        WeatherData weatherData = new WeatherData();
        CurrentConditionsDisplay conditionsDisplay = new CurrentConditionsDisplay(weatherData);
        weatherData.setMeasurements(19, 97, 0);
        weatherData.setMeasurements(19, 97, 7);
        weatherData.setMeasurements(19, 97, 3);
        weatherData.setMeasurements(19, 97, 1);
    }
}
```

```
> Task :WeatherStationSimulator.main()
14:42:35.636 [main] INFO com.observerpattern.CurrentConditionsDisplay - Current conditions: 19.0 F degrees and 97.0 % humidity and 0.0 pressure
14:42:35.636 [main] INFO com.observerpattern.CurrentConditionsDisplay - Current conditions: 19.0 F degrees and 97.0 % humidity and 7.0 pressure
14:42:35.636 [main] INFO com.observerpattern.CurrentConditionsDisplay - Current conditions: 19.0 F degrees and 97.0 % humidity and 3.0 pressure
14:42:35.636 [main] INFO com.observerpattern.CurrentConditionsDisplay - Current conditions: 19.0 F degrees and 97.0 % humidity and 1.0 pressure
```
